#!/usr/bin/env node

// 命令行执行: find_chinese.js wow/chrome/browser ['.html', '.js', '.css']

'use strict';

var fs = require('fs'),
  readline = require('readline'),
  path = require('path'),
  findChinese = require('../lib/find-chinese'),
  argv       = require('optimist')
  .boolean('cors')
  .argv;

var fileSuffix = process.argv[2] || [];
var walk = findChinese.walk;
var readFile = findChinese.readFile;

if (argv.h || argv.help) {
  console.log([
    'usage: find-chinese [path] [fileSuffix]',
    '',
    'options:',
    '  path           directory path to find',
    '  fileSuffix     file suffixs array, like [".html", ".js", ".css"]',
  ].join('\n'));
  process.exit();
}

fs.writeFile('chinese.txt', '', function(err) {
  if (err) throw err;
});

walk(process.argv[1] || '.', fileSuffix, function(err, results) {
  if (err) throw err;
  console.log('查找路径：', process.argv[1] || '.');  
  console.log('共找到' + results.length + '个文件 in', fileSuffix);
  console.log('请到chinese.txt查看结果');

  for (var i = 0; i < results.length; i++) {
    readFile(results[i]);
  };
});